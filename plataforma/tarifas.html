<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Tarifador de Servicios</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts for nice look -->
  <link href="https://fonts.googleapis.com/css?family=Segoe+UI:400,700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: transparent;
      padding-bottom: 0;
      min-height: 100vh;
    }
    .header-tarifador {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      padding: 28px 24px 0 24px;
    }
    .tarifador-title {
      font-size: 1.18em;
      font-weight: bold;
      font-style: italic;
      color: #006064;
      background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
      padding: 14px 26px;
      border-radius: 30px;
      border: 2.5px solid #00bcd4;
      box-shadow: 0 2px 16px rgba(0,151,167,0.13);
      letter-spacing: 0.04em;
      text-align: right;
      min-width: 280px;
      transition: border-color 0.2s;
    }
    .tarifador-title:hover {
      border-color: #ff6f00;
    }
    .tarifas-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 32px;
      justify-content: center;
      margin: 36px auto 48px auto;
      max-width: 1140px;
    }
    .tarifa-card {
      width: 320px;
      background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
      border-radius: 22px;
      box-shadow: 0 6px 26px rgba(0,151,167,0.13);
      border: 2.5px solid #00bcd4;
      padding: 0;
      margin-bottom: 0;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
      transition: transform 0.18s, box-shadow 0.18s, border-color 0.18s;
    }
    .tarifa-card:hover {
      transform: scale(1.035);
      box-shadow: 0 10px 32px rgba(0,151,167,0.23);
      border-color: #0097a7;
      z-index: 2;
    }
    .tarifa-servicio {
      font-size: 1.15em;
      font-weight: bold;
      background: #fff;
      color: #006064;
      padding: 18px 18px 10px 18px;
      border-radius: 22px 22px 0 0;
      border-bottom: 1.5px solid #b2ebf2;
      min-height: 48px;
      text-align: center;
      letter-spacing: 0.02em;
    }
    .tarifa-descripcion {
      font-size: 1em;
      color: #333;
      padding: 10px 20px 0 20px;
      min-height: 44px;
      text-align: center;
    }
    .tarifa-valor {
      font-size: 1.16em;
      color: #0097a7;
      font-weight: bold;
      margin: 16px 0 0 0;
      text-align: center;
      letter-spacing: 0.01em;
    }
    .tarifa-promocion,
    .tarifa-adicional {
      font-size: 0.98em;
      color: #ff6f00;
      background: #fffde7;
      border-radius: 14px;
      margin: 10px 24px 0 24px;
      padding: 5px 10px;
      min-height: 26px;
      text-align: center;
    }
    .tarifa-adicional {
      color: #388e3c;
      background: #e8f5e9;
      margin-bottom: 18px;
    }
    @media (max-width: 950px) {
      .tarifas-grid { gap: 18px; }
      .tarifa-card { width: 94vw; max-width: 320px; }
    }
    @media (max-width: 600px) {
      .tarifas-grid {
        flex-direction: column;
        align-items: center;
        gap: 18px;
      }
      .tarifa-card {
        width: 96vw;
        max-width: 350px;
      }
    }
  </style>
</head>
<body>
  <div class="header-tarifador">
    <div class="tarifador-title" id="periodo-titulo">
      VALORES CORRESPONDIENTES AL PERIODO JULIO/SEPTIEMBRE 2025
    </div>
  </div>
  <div class="tarifas-grid" id="tarifas-contenedor">
    <!-- Aquí se insertarán las tarjetas con JS -->
  </div>
  <script>
    // CONFIGURACIÓN: Cambiar esta variable si cambia el rango de periodo en la hoja de cálculo:
    let periodoTitulo = "";

    // ID y rango de la hoja Google Sheets
    const SHEET_ID = "1DJzPw-dmc3gEO7SjedaSS5dFww-85_sJbeDsJSTtnsU";
    const SHEET_NAME = "valores";
    const API_KEY = ""; // <-- Colocar aquí su API KEY de Google Sheets si desea hacerlo público

    // Si el archivo es solo para uso privado, puedes usar una API proxy o publicar la hoja como CSV y leerla directamente.
    // A continuación se muestra un ejemplo usando fetch de una hoja publicada como CSV:
    const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;

    // Helper para parsear CSV simple
    function parseCSV(text) {
      const rows = text.trim().split('\n');
      return rows.map(row => {
        // Soporta comillas dobles y valores con comas
        const regex = /("([^"]|"")*"|[^,]*)/g;
        let cols = [];
        let match;
        while ((match = regex.exec(row)) !== null) {
          let val = match[0].trim();
          if (val.startsWith('"') && val.endsWith('"')) {
            val = val.slice(1, -1).replace(/""/g, '"');
          }
          cols.push(val);
          if (regex.lastIndex >= row.length) break;
          regex.lastIndex++; // skip comma
        }
        return cols;
      });
    }

    // Renderizar tarjetas en el DOM
    function renderTarifas(datos) {
      const contenedor = document.getElementById('tarifas-contenedor');
      contenedor.innerHTML = "";
      datos.slice(0, 10).forEach(row => {
        if (row.length < 5) return; // Salto filas incompletas
        const [servicio, descripcion, valor, promocion, adicional] = row;
        // Oculta la fila si el servicio está vacío
        if (!servicio || servicio.toLowerCase().includes('servicio')) return;

        const card = document.createElement('div');
        card.className = 'tarifa-card';
        card.innerHTML = `
          <div class="tarifa-servicio">${servicio}</div>
          <div class="tarifa-descripcion">${descripcion || ''}</div>
          <div class="tarifa-valor">${(valor && valor !== '0') ? '$ ' + valor : 'Consultar'}</div>
          ${promocion ? `<div class="tarifa-promocion">Promoción: ${promocion}</div>` : ''}
          ${adicional ? `<div class="tarifa-adicional">${adicional}</div>` : ''}
        `;
        contenedor.appendChild(card);
      });
    }

    // Renderizar el título de periodo (puede ser tomado dinámicamente de la hoja si se agrega un campo)
    function setPeriodoTitulo(text) {
      document.getElementById('periodo-titulo').textContent = text || "VALORES CORRESPONDIENTES AL PERIODO JULIO/SEPTIEMBRE 2025";
    }

    // Obtener y mostrar datos
    fetch(CSV_URL)
      .then(resp => resp.ok ? resp.text() : Promise.reject("No se pudo obtener datos"))
      .then(csv => {
        const datos = parseCSV(csv);
        // Si la planilla tiene un título de periodo en la primera fila o celda, puedes tomarlo así:
        // periodoTitulo = datos[0][0].includes("VALORES") ? datos[0][0] : "";
        // setPeriodoTitulo(periodoTitulo);
        renderTarifas(datos);
      })
      .catch(err => {
        document.getElementById('tarifas-contenedor').innerHTML = `<div style="color:#d84315;padding:32px;">No se pudieron cargar los valores. Intente más tarde.</div>`;
      });
  </script>
</body>
</html>
