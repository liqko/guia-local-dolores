<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Bolsa de Empleo - CVs y Ofertas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { margin:0; font-family:'Segoe UI',Arial,sans-serif; background:#f4fcfd; color:#01434c;}
    .main-content {
      max-width: 1000px; 
      margin:38px auto 22px auto; 
      background:#ecfdff; 
      border-radius:22px; 
      border:2.5px solid #00bcd4; 
      box-shadow:0 8px 38px rgba(0,151,167,0.09); 
      padding:26px 24px 18px 24px;
    }
    .logo-bolsa {display:block; margin:0 auto 14px auto; max-width:104px; width:32vw;}
    h1 {text-align:center; color:#00bcd4; margin:0 0 16px 0; font-size:1.5em;}
    .intro {font-size:1.09em; color:#006064; margin-bottom:8px;}
    .separador-p {margin-bottom:18px;}
    h2 {color:#0097a7; margin:38px 0 8px 0; font-size:1.22em;}
    .seccion {margin-bottom:40px;}
    .cards {display:flex; flex-wrap:wrap; gap:20px; margin-top:13px;}
    .card {
      background:#fff; border-radius:15px; box-shadow:0 2px 14px #b2ebf255; border:1.5px solid #b2ebf2;
      padding:18px 16px 12px 16px; width:calc(50% - 24px); min-width:260px; max-width:400px;
      display:flex; flex-direction:column; gap:7px;
    }
    .card-cv .cv-foto {max-width:70px; max-height:70px; border-radius:14px; border:1.5px solid #b2ebf2; margin-bottom:7px;}
    .card-titulo {font-weight:bold; color:#007c91; font-size:1.11em;}
    .card-sub {color:#0097a7; font-size:1em;}
    .card-area {font-size:0.98em; color:#006064;}
    .card-presentacion, .card-descripcion {font-size:0.99em; color:#636363;}
    .card-zona {font-size:0.97em; color:#888; margin-top:2px;}
    .card-email {font-size:0.96em; color:#0097a7;}
    .nada {color:#b71c1c; margin:23px 0 0 0; text-align:center;}
    .tabs {
      display: flex;
      justify-content: center;
      margin: 30px 0 10px 0;
      gap: 10px;
    }
    .tab-btn {
      background: #fff;
      color: #0097a7;
      border: 1.5px solid #00bcd4;
      border-radius: 12px 12px 0 0;
      font-size: 1.11em;
      font-weight: bold;
      padding: 9px 28px;
      cursor: pointer;
      margin: 0 2px;
      transition: background 0.13s, color 0.13s;
      outline: none;
    }
    .tab-btn.active, .tab-btn:focus {
      background: linear-gradient(90deg, #00bcd4 60%, #00acc1 100%);
      color: #fff;
      border-bottom: 2.5px solid #ecfdff;
      z-index: 2;
    }
    .tab-content {display:none;}
    .tab-content.active {display:block;}
    .paginator {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 14px;
      margin-bottom: 14px;
      margin-top: 12px;
    }
    .paginator button {
      padding: 7px 18px;
      font-size: 1em;
      border: none;
      background: #00bcd4;
      color: #fff;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 2px 7px rgba(44,60,90,0.07);
      font-style: italic;
    }
    .paginator button[disabled] {
      background: #b2ebf2;
      cursor: not-allowed;
    }
    .paginator .page-info {
      font-size: 1.06em;
      color: #01434c;
      font-weight: 500;
      min-width: 55px;
      text-align: center;
    }
    .zocalo {
      width:100%;
      background:linear-gradient(90deg,#00bcd4 60%,#00acc1 100%);
      border-radius:17px;
      margin-top:32px;
      min-height:74px;
      display:flex;
      flex-direction:column;
      align-items:center;
      box-shadow:0 -3px 18px #00bcd444;
      padding:9px 0 3px 0;
      position:relative;
      gap:0;
    }
    .zocalo-mensaje {
      width:100%;
      text-align:center;
      color:#fff;
      font-size:1.05em;
      font-weight:500;
      margin-bottom:5px;
      margin-top:8px;
      letter-spacing:0.01em;
      text-shadow:0 2px 8px #00bcd455;
    }
    .zocalo-links {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:38px;
      width:100%;
    }
    .zocalo-link {
      display:flex;
      flex-direction:column;
      align-items:center;
      color:#fff;
      text-decoration:none;
      font-size:1em;
      font-weight:bold;
      transition:color 0.18s;
      min-width:82px;
    }
    .zocalo-link img {
      width:32px; height:32px; margin-bottom:2px; border-radius:8px; background:#fff; box-shadow:0 2px 10px rgba(0,188,212,0.07);
      object-fit:contain;
      display:block;
    }
    .zocalo-link:hover {color:#ffe082;}
    .zocalo-link:hover img {box-shadow:0 0 0 2px #ffe082;}
    @media (max-width: 900px) {.main-content{padding:13px 2vw 7vw 2vw;} .card{width:100%; min-width:0;}}
    @media (max-width: 600px) {
      .main-content{max-width:99vw;}
      .zocalo-links{gap:0; justify-content:space-around;}
      .zocalo{font-size:0.97em;}
      .zocalo-link{min-width:48px; font-size:0.93em;}
      .zocalo-link img{width:22vw; height:22vw; max-width:48px; max-height:48px;}
    }
  </style>
</head>
<body>
  <div class="main-content">
    <!-- Logo/Icono superior -->
    <img src="https://raw.githubusercontent.com/liqko/guia-local-dolores/refs/heads/main/img/plataforma/bolsa-empleo.png" alt="Bolsa de Empleo Dolores" class="logo-bolsa">
    <h1>Bolsa de Empleo</h1>
    <p class="intro separador-p">
      Encontrá oportunidades laborales en Dolores o publicá tu perfil para que te contacten empleadores de la ciudad y la zona.
    </p>
    <div class="tabs">
      <button class="tab-btn active" data-tab="cv">CVs publicados</button>
      <button class="tab-btn" data-tab="oferta">Ofertas laborales</button>
    </div>

    <!-- TAB CV -->
    <div id="tab-cv" class="tab-content active">
      <input type="text" id="buscar-cv" class="search-box" placeholder="Buscar CV por puesto, área, zona...">
      <div class="cards" id="cv-cards"></div>
      <div class="nada" id="cv-vacio" style="display:none;">No hay CVs publicados aún.</div>
      <div class="paginator" id="cv-paginator"></div>
    </div>

    <!-- TAB OFERTAS -->
    <div id="tab-oferta" class="tab-content">
      <input type="text" id="buscar-oferta" class="search-box" placeholder="Buscar oferta por puesto, área, zona, empresa...">
      <div class="cards" id="oferta-cards"></div>
      <div class="nada" id="oferta-vacio" style="display:none;">No hay ofertas activas en este momento.</div>
      <div class="paginator" id="oferta-paginator"></div>
    </div>

    <div class="zocalo">
      <div class="zocalo-mensaje">
        Publicá tu CV u Oferta Laboral de forma segura y sin datos sensibles.
      </div>
      <div class="zocalo-links">
        <a class="zocalo-link" href="https://www.guialocaldolores.com.ar/empleo/cv/" title="Cargar mi CV">
          <img src="https://raw.githubusercontent.com/liqko/guia-local-dolores/refs/heads/main/img/plataforma/cv.png" alt="Cargar CV" />
          Cargar CV
        </a>
        <a class="zocalo-link" href="https://www.guialocaldolores.com.ar/empleo/oferta/" title="Publicar Oferta">
          <img src="https://raw.githubusercontent.com/liqko/guia-local-dolores/refs/heads/main/img/plataforma/bolsa-empleo.png" alt="Publicar Oferta" />
          Publicar oferta
        </a>
        <a class="zocalo-link" href="https://www.guialocaldolores.com.ar/" title="Ir al Inicio de la plataforma">
          <img src="https://raw.githubusercontent.com/liqko/guia-local-dolores/refs/heads/main/img/plataforma/inicio.png" alt="Ir al Inicio de la plataforma" />
          Inicio
        </a>
      </div>
    </div>
  </div>
  <script>
    // Cambia la URL por la de tu Apps Script desplegado
    const gsURL = 'https://script.google.com/macros/s/TU_WEBAPP_ID/exec';
    let cvsData = [], ofertasData = [];
    let paginaCV = 1, paginaOferta = 1;
    const porPagina = 6;

    // Tabs handling
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));
        this.classList.add('active');
        document.getElementById('tab-'+this.getAttribute('data-tab')).classList.add('active');
      });
    });

    // Render y filtro/paginador para CVs
    function renderCVs(datos, pagina=1, filtro="") {
      const cards = document.getElementById('cv-cards');
      cards.innerHTML = "";
      let filtrados = datos.filter(cv => {
        if (!filtro) return true;
        const texto = [
          cv.puesto, cv.area, cv.presentacion, cv.experiencia, cv.educacion, cv.zona
        ].join(" ").toLowerCase();
        return texto.includes(filtro.toLowerCase());
      });
      const total = filtrados.length;
      const totalPaginas = Math.ceil(total / porPagina) || 1;
      const inicio = (pagina-1)*porPagina;
      const fin = inicio + porPagina;
      filtrados.slice(inicio, fin).forEach(cv => {
        let foto = cv.foto ? `<img class="cv-foto" src="${cv.foto}" alt="Foto">` : '';
        let html = `<div class="card card-cv">
          ${foto}
          <div class="card-titulo">${cv.puesto || 'Puesto no especificado'}</div>
          <div class="card-area">${cv.area || ''}</div>
          <div class="card-presentacion">${cv.presentacion || ''}</div>
          <div class="card-sub">${cv.experiencia ? 'Exp: '+cv.experiencia : ''}</div>
          <div class="card-sub">${cv.educacion ? 'Edu: '+cv.educacion : ''}</div>
          <div class="card-zona">${cv.zona ? 'Zona: '+cv.zona : ''}</div>
        </div>`;
        cards.innerHTML += html;
      });
      document.getElementById('cv-vacio').style.display = (total === 0) ? '' : 'none';
      renderPaginator("cv", total, pagina, totalPaginas);
    }

    // Render y filtro/paginador para Ofertas
    function renderOfertas(datos, pagina=1, filtro="") {
      const cards = document.getElementById('oferta-cards');
      cards.innerHTML = "";
      let filtrados = datos.filter(of => {
        if (!filtro) return true;
        const texto = [
          of.titulo, of.area, of.descripcion, of.empresa, of.requisitos, of.zona
        ].join(" ").toLowerCase();
        return texto.includes(filtro.toLowerCase());
      });
      const total = filtrados.length;
      const totalPaginas = Math.ceil(total / porPagina) || 1;
      const inicio = (pagina-1)*porPagina;
      const fin = inicio + porPagina;
      filtrados.slice(inicio, fin).forEach(of => {
        let html = `<div class="card card-oferta">
          <div class="card-titulo">${of.titulo || 'Puesto no especificado'}</div>
          <div class="card-area">${of.area || ''}</div>
          <div class="card-descripcion">${of.descripcion || ''}</div>
          <div class="card-sub">${of.empresa ? 'Empresa: '+of.empresa : ''}</div>
          <div class="card-sub">${of.requisitos ? 'Requisitos: '+of.requisitos : ''}</div>
          <div class="card-zona">${of.zona ? 'Zona: '+of.zona : ''}</div>
        </div>`;
        cards.innerHTML += html;
      });
      document.getElementById('oferta-vacio').style.display = (total === 0) ? '' : 'none';
      renderPaginator("oferta", total, pagina, totalPaginas);
    }

    // Paginador común
    function renderPaginator(tipo, total, pagina, totalPaginas) {
      const pagDiv = document.getElementById(tipo + '-paginator');
      if (totalPaginas <= 1) { pagDiv.innerHTML = ""; return; }
      pagDiv.innerHTML = `
        <button ${pagina <= 1 ? "disabled" : ""} onclick="cambiarPagina('${tipo}', ${pagina-1})">Anterior</button>
        <span class="page-info">Página ${pagina} / ${totalPaginas}</span>
        <button ${pagina >= totalPaginas ? "disabled" : ""} onclick="cambiarPagina('${tipo}', ${pagina+1})">Siguiente</button>
      `;
    }

    // Cambio de página global
    window.cambiarPagina = function(tipo, nuevaPag) {
      if (tipo === "cv") { 
        paginaCV = nuevaPag; 
        renderCVs(cvsData, paginaCV, document.getElementById('buscar-cv').value); 
      }
      if (tipo === "oferta") { 
        paginaOferta = nuevaPag; 
        renderOfertas(ofertasData, paginaOferta, document.getElementById('buscar-oferta').value); 
      }
    }

    document.getElementById('buscar-cv').addEventListener('input', function() {
      paginaCV = 1;
      renderCVs(cvsData, paginaCV, this.value);
    });

    document.getElementById('buscar-oferta').addEventListener('input', function() {
      paginaOferta = 1;
      renderOfertas(ofertasData, paginaOferta, this.value);
    });

    // Fetch datos
    fetch(gsURL+'?tipo=cv')
      .then(r=>r.json())
      .then(arr=>{
        cvsData = arr;
        renderCVs(cvsData, paginaCV, "");
      });

    fetch(gsURL+'?tipo=oferta')
      .then(r=>r.json())
      .then(arr=>{
        ofertasData = arr;
        renderOfertas(ofertasData, paginaOferta, "");
      });
  </script>
</body>
</html>
