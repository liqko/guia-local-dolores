<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Prueba subida Cloudinary</title>
</head>
<body>
  <h2>Prueba directa de subida a Cloudinary</h2>
  <input type="file" id="foto_archivo" accept="image/*">
  <button onclick="subir()">Subir imagen</button>
  <p id="status"></p>
  <img id="preview" style="max-width:300px; max-height:200px; display:none;">
  <script>
    async function subir() {
      document.getElementById('status').innerText = "Subiendo...";
      const file = document.getElementById('foto_archivo').files[0];
      if (!file) {
        document.getElementById('status').innerText = "Seleccioná una imagen primero.";
        return;
      }
      const data = new FormData();
      data.append('file', file);
      data.append('upload_preset', 'cv_unsigned');
      try {
        const resp = await fetch('https://api.cloudinary.com/v1_1/dw3oovvb1/image/upload', {
          method: 'POST', body: data
        });
        const json = await resp.json();
        if (json.secure_url) {
          document.getElementById('status').innerText = "¡Imagen subida!";
          document.getElementById('preview').src = json.secure_url;
          document.getElementById('preview').style.display = "block";
        } else {
          document.getElementById('status').innerText = "Error: " + (json.error?.message || "Respuesta inesperada");
        }
      } catch(e) {
        document.getElementById('status').innerText = "Error de red o CORS";
      }
    }
  </script>
</body>
</html>
